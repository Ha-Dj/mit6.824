000010 LOG1 S0, making...
000019 LOG1 S1, making...
000020 LOG1 S2, making...
Test (2A): election after network failure ...
003666 TIMR S1 T0 follower election timeout, converting to Candidate
003680 VOTE S0 T0 vote for S1, converting to follower.
003680 VOTE S2 T0 vote for S1, converting to follower.
003681 TIMR S0 T1 reset election timeout. (RequestVote: 0 vote for 1)
003681 TIMR S2 T1 reset election timeout. (RequestVote: 2 vote for 1)
003681 TIMR S2 T1 follower election timeout, converting to Candidate
003685 VOTE S0 T1 vote for S2, converting to follower.
003686 TIMR S0 T2 reset election timeout. (RequestVote: 0 vote for 2)
003685 LEAD S1 T1 achieved majority for term(2), 1 > 1 , converting to Leader! 
003686 VOTE S1 T1 vote for S2, converting to follower.
003688 LEAD S2 T2 achieved majority for term(2), 1 > 2 , converting to Leader! 
003696 TIMR S0 T2 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
003687 TIMR S1 T2 reset election timeout. (RequestVote: 1 vote for 2)
003713 TIMR S1 T2 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
==================
WARNING: DATA RACE
Read at 0x00c0000d41b8 by goroutine 38:
  6.824/raft.(*Raft).startHeartBeat()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:367 +0x30
  6.824/raft.(*Raft).startElection.func3()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x34

Previous write at 0x00c0000d41b8 by goroutine 37:
  6.824/raft.(*Raft).RequestVote()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:413 +0x19c
  runtime.call32()
      /usr/local/go/src/runtime/asm_arm64.s:479 +0x74
  reflect.Value.Call()
      /usr/local/go/src/reflect/value.go:380 +0x90
  6.824/labrpc.(*Service).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:496 +0x334
  6.824/labrpc.(*Server).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:420 +0x1f0
  6.824/labrpc.(*Network).processReq.func1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:240 +0x84

Goroutine 38 (running) created at:
  6.824/raft.(*Raft).startElection()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x550
  6.824/raft.(*Raft).ticker.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:615 +0x34

Goroutine 37 (finished) created at:
  6.824/labrpc.(*Network).processReq()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:239 +0x20c
  6.824/labrpc.MakeNetwork.func1.1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:157 +0x84
==================
007351 TIMR S0 T2 follower election timeout, converting to Candidate
007357 VOTE S1 T2 vote for S0, converting to follower.
007357 TIMR S1 T3 reset election timeout. (RequestVote: 1 vote for 0)
007360 LEAD S0 T3 achieved majority for term(2), 1 > 3 , converting to Leader! 
007364 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
008370 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
009368 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
010370 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
010372 TIMR S2 T3 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
011380 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
011380 TIMR S2 T3 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
012380 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
012380 TIMR S2 T3 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
013387 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
013387 TIMR S2 T3 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
014387 TIMR S1 T3 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
014387 TIMR S2 T3 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
018969 TIMR S1 T3 follower election timeout, converting to Candidate
019360 TIMR S2 T3 follower election timeout, converting to Candidate
023722 TIMR S2 T4 candidate election timeout, converting to Candidate
023961 TIMR S1 T4 candidate election timeout, converting to Candidate
028252 TIMR S2 T5 candidate election timeout, converting to Candidate
028795 TIMR S1 T5 candidate election timeout, converting to Candidate
032759 TIMR S1 T6 candidate election timeout, converting to Candidate
033054 TIMR S2 T6 candidate election timeout, converting to Candidate
037038 TIMR S1 T7 candidate election timeout, converting to Candidate
037040 VOTE S2 T7 vote for S1, converting to follower.
037041 TIMR S2 T8 reset election timeout. (RequestVote: 2 vote for 1)
037042 LEAD S1 T8 achieved majority for term(2), 1 > 8 , converting to Leader! 
037044 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
038049 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
039050 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
040069 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
041068 TIMR S0 T8 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
041068 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
042073 TIMR S0 T8 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
042073 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
043081 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
043081 TIMR S0 T8 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
044077 TIMR S0 T8 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
044077 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
045088 TIMR S2 T8 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
045089 TIMR S0 T8 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
--- FAIL: TestReElection2A (4.54s)
    testing.go:1465: race detected during execution of test
FAIL
exit status 1
FAIL	6.824/raft	6.171s

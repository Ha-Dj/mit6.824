000006 LOG1 S0, making...
000011 LOG1 S1, making...
000012 LOG1 S2, making...
Test (2B): basic agreement ...
003704 TIMR S1 T0 follower election timeout, converting to Candidate
003725 VOTE S2 T0 vote for S1, converting to follower.
003726 TIMR S2 T1 reset election timeout. (RequestVote: 2 vote for 1)
003725 VOTE S0 T0 vote for S1, converting to follower.
003727 TIMR S0 T1 reset election timeout. (RequestVote: 0 vote for 1)
003728 TIMR S0 T1 follower election timeout, converting to Candidate
003731 LEAD S1 T1 achieved majority for term(2), 1 > 1 , converting to Leader! 
003735 VOTE S2 T1 vote for S0, converting to follower.
003735 TIMR S2 T2 reset election timeout. (RequestVote: 2 vote for 0)
003740 VOTE S1 T1 vote for S0, converting to follower.
003742 LEAD S0 T2 achieved majority for term(2), 1 > 2 , converting to Leader! 
==================
WARNING: DATA RACE
Write at 0x00c00015c1b8 by goroutine 37:
  6.824/raft.(*Raft).RequestVote()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:413 +0x19c
  runtime.call32()
      /usr/local/go/src/runtime/asm_arm64.s:479 +0x74
  reflect.Value.Call()
      /usr/local/go/src/reflect/value.go:380 +0x90
  6.824/labrpc.(*Service).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:496 +0x334
  6.824/labrpc.(*Server).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:420 +0x1f0
  6.824/labrpc.(*Network).processReq.func1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:240 +0x84

Previous read at 0x00c00015c1b8 by goroutine 35:
  6.824/raft.(*Raft).startHeartBeat()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:367 +0x30
  6.824/raft.(*Raft).startElection.func3()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x34

Goroutine 37 (running) created at:
  6.824/labrpc.(*Network).processReq()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:239 +0x20c
  6.824/labrpc.MakeNetwork.func1.1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:157 +0x84

Goroutine 35 (finished) created at:
  6.824/raft.(*Raft).startElection()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x550
  6.824/raft.(*Raft).ticker.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:615 +0x34
==================
003753 TIMR S1 T2 reset election timeout. (RequestVote: 1 vote for 0)
003761 TIMR S2 T2 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
003762 TIMR S1 T2 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
004065 CLNT S0 leader Term 2 append new log nextIndex2 matchIndex1
004122 LEAD S0 leader Term 2 Broadcast appendEntries
004123 LEAD S0 prevIndex0
004124 LEAD S0 prevIndex0
004134 LOG2 S1 follower Term2 append new log, len(rf.log) 1, args.PrevLogIndex 0
004134 LOG2 S2 follower Term2 append new log, len(rf.log) 1, args.PrevLogIndex 0
004135 WARN S1 follower Term2 append new log, len 2
004135 WARN S2 follower Term2 append new log, len 2
004139 LEAD S0 leader Term 2 appendEntries success: commitIndex1
004140 LEAD S0 leader Term 2 appendEntries success: commitIndex1
004224 CMIT S0 leader Term2 commit{CommandIndex:1}
004225 CMIT S0 leader Term2 commit
005262 TIMR S1 T2 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
005262 TIMR S2 T2 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
005308 CMIT S1 follower Term2 commit{CommandIndex:1}
005308 CMIT S2 follower Term2 commit{CommandIndex:1}
005309 CMIT S1 follower Term2 commit
005309 CMIT S2 follower Term2 commit
005503 CLNT S0 leader Term 2 append new log nextIndex3 matchIndex2
005515 LEAD S0 leader Term 2 Broadcast appendEntries
005516 LEAD S0 prevIndex1
005516 LEAD S0 prevIndex1
005525 LOG2 S2 follower Term2 append new log, len(rf.log) 2, args.PrevLogIndex 1
005525 LOG2 S1 follower Term2 append new log, len(rf.log) 2, args.PrevLogIndex 1
005526 WARN S2 follower Term2 append new log, len 3
005526 WARN S1 follower Term2 append new log, len 3
005530 LEAD S0 leader Term 2 appendEntries success: commitIndex2
005531 LEAD S0 leader Term 2 appendEntries success: commitIndex2
005620 CMIT S0 leader Term2 commit{CommandIndex:2}
005621 CMIT S0 leader Term2 commit
006764 TIMR S2 T2 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 1)
006764 TIMR S1 T2 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 1)
006771 CMIT S1 follower Term2 commit{CommandIndex:2}
006771 CMIT S2 follower Term2 commit{CommandIndex:2}
006771 CMIT S1 follower Term2 commit
006772 CMIT S2 follower Term2 commit
006947 CLNT S0 leader Term 2 append new log nextIndex4 matchIndex3
006986 LEAD S0 leader Term 2 Broadcast appendEntries
006986 LEAD S0 prevIndex2
006986 LEAD S0 prevIndex2
006989 LOG2 S2 follower Term2 append new log, len(rf.log) 3, args.PrevLogIndex 2
006989 WARN S2 follower Term2 append new log, len 4
006989 LOG2 S1 follower Term2 append new log, len(rf.log) 3, args.PrevLogIndex 2
006990 WARN S1 follower Term2 append new log, len 4
006991 LEAD S0 leader Term 2 appendEntries success: commitIndex3
006991 LEAD S0 leader Term 2 appendEntries success: commitIndex3
007096 CMIT S0 leader Term2 commit{CommandIndex:3}
007097 CMIT S0 leader Term2 commit
008271 TIMR S2 T2 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 2)
008271 TIMR S1 T2 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 2)
008377 CMIT S1 follower Term2 commit{CommandIndex:3}
008377 CMIT S2 follower Term2 commit{CommandIndex:3}
008378 CMIT S1 follower Term2 commit
008379 CMIT S2 follower Term2 commit
--- FAIL: TestBasicAgree2B (0.86s)
    testing.go:1465: race detected during execution of test
FAIL
exit status 1
FAIL	6.824/raft	21.432s

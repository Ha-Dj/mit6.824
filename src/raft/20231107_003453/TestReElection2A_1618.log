000005 LOG1 S0, making...
000010 LOG1 S1, making...
000011 LOG1 S2, making...
Test (2A): election after network failure ...
003760 TIMR S1 T0 follower election timeout, converting to Candidate
003792 TIMR S0 T0 follower election timeout, converting to Candidate
003794 VOTE S2 T0 vote for S1, converting to follower.
003795 VOTE S0 T0 vote for S1, converting to follower.
003796 TIMR S2 T1 reset election timeout. (RequestVote: 2 vote for 1)
003796 TIMR S0 T1 reset election timeout. (RequestVote: 0 vote for 1)
003804 LEAD S1 T1 achieved majority for term(2), 1 > 1 , converting to Leader! 
003804 VOTE S2 T1 vote for S0, converting to follower.
003805 VOTE S1 T1 vote for S0, converting to follower.
003805 TIMR S2 T2 reset election timeout. (RequestVote: 2 vote for 0)
==================
WARNING: DATA RACE
Write at 0x00c0000d21b8 by goroutine 36:
  6.824/raft.(*Raft).RequestVote()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:413 +0x19c
  runtime.call32()
      /usr/local/go/src/runtime/asm_arm64.s:479 +0x74
  reflect.Value.Call()
      /usr/local/go/src/reflect/value.go:380 +0x90
  6.824/labrpc.(*Service).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:496 +0x334
  6.824/labrpc.(*Server).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:420 +0x1f0
  6.824/labrpc.(*Network).processReq.func1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:240 +0x84

Previous read at 0x00c0000d21b8 by goroutine 37:
  6.824/raft.(*Raft).startHeartBeat()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:367 +0x30
  6.824/raft.(*Raft).startElection.func3()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x34

Goroutine 36 (running) created at:
  6.824/labrpc.(*Network).processReq()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:239 +0x20c
  6.824/labrpc.MakeNetwork.func1.1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:157 +0x84

Goroutine 37 (finished) created at:
  6.824/raft.(*Raft).startElection()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x550
  6.824/raft.(*Raft).ticker.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:615 +0x34
==================
003815 TIMR S1 T2 reset election timeout. (RequestVote: 1 vote for 0)
007655 TIMR S2 T2 follower election timeout, converting to Candidate
007667 VOTE S1 T2 vote for S2, converting to follower.
007667 VOTE S0 T2 vote for S2, converting to follower.
007668 TIMR S1 T3 reset election timeout. (RequestVote: 1 vote for 2)
007669 TIMR S0 T3 reset election timeout. (RequestVote: 0 vote for 2)
007677 LEAD S2 T3 achieved majority for term(2), 1 > 3 , converting to Leader! 
007690 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
007691 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
008694 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
008694 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
013027 TIMR S1 T3 follower election timeout, converting to Candidate
013039 VOTE S0 T3 vote for S1, converting to follower.
013040 TIMR S0 T4 reset election timeout. (RequestVote: 0 vote for 1)
013047 LEAD S1 T4 achieved majority for term(2), 1 > 4 , converting to Leader! 
013055 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
014065 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
015076 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
015076 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
016089 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
016089 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
017106 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
017106 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
018116 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
018121 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
019133 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
019133 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
022804 TIMR S0 T4 follower election timeout, converting to Candidate
023593 TIMR S2 T4 follower election timeout, converting to Candidate
027233 TIMR S2 T5 candidate election timeout, converting to Candidate
027646 TIMR S0 T5 candidate election timeout, converting to Candidate
031698 TIMR S0 T6 candidate election timeout, converting to Candidate
032160 TIMR S2 T6 candidate election timeout, converting to Candidate
036043 TIMR S0 T7 candidate election timeout, converting to Candidate
036395 TIMR S2 T7 candidate election timeout, converting to Candidate
040784 TIMR S2 T8 candidate election timeout, converting to Candidate
040794 VOTE S0 T8 vote for S2, converting to follower.
040795 TIMR S0 T9 reset election timeout. (RequestVote: 0 vote for 2)
040799 LEAD S2 T9 achieved majority for term(2), 1 > 9 , converting to Leader! 
040805 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
041807 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
042822 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
043821 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
044833 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
044834 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
045843 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
045843 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
046843 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
046843 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
047844 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
047844 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
--- FAIL: TestReElection2A (4.85s)
    testing.go:1465: race detected during execution of test
FAIL
exit status 1
FAIL	6.824/raft	4.944s

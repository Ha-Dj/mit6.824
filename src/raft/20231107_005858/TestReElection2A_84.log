000007 LOG1 S0, making...
000013 LOG1 S1, making...
000014 LOG1 S2, making...
Test (2A): election after network failure ...
003669 TIMR S1 T0 follower election timeout, converting to Candidate
003676 VOTE S0 T0 vote for S1, converting to follower.
003676 VOTE S2 T0 vote for S1, converting to follower.
003677 TIMR S0 T1 reset election timeout. (RequestVote: 0 vote for 1)
003677 TIMR S2 T1 reset election timeout. (RequestVote: 2 vote for 1)
003677 TIMR S0 T1 follower election timeout, converting to Candidate
003679 LEAD S1 T1 achieved majority for term(2), 1 > 1 , converting to Leader! 
003679 VOTE S1 T1 vote for S0, converting to follower.
003679 VOTE S2 T1 vote for S0, converting to follower.
003679 TIMR S2 T2 reset election timeout. (RequestVote: 2 vote for 0)
==================
WARNING: DATA RACE
Write at 0x00c00015c1b8 by goroutine 36:
  6.824/raft.(*Raft).RequestVote()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:413 +0x19c
  runtime.call32()
      /usr/local/go/src/runtime/asm_arm64.s:479 +0x74
  reflect.Value.Call()
      /usr/local/go/src/reflect/value.go:380 +0x90
  6.824/labrpc.(*Service).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:496 +0x334
  6.824/labrpc.(*Server).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:420 +0x1f0
  6.824/labrpc.(*Network).processReq.func1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:240 +0x84

Previous read at 0x00c00015c1b8 by goroutine 38:
  6.824/raft.(*Raft).startHeartBeat()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:367 +0x30
  6.824/raft.(*Raft).startElection.func3()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x34

Goroutine 36 (running) created at:
  6.824/labrpc.(*Network).processReq()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:239 +0x20c
  6.824/labrpc.MakeNetwork.func1.1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:157 +0x84

Goroutine 38 (finished) created at:
  6.824/raft.(*Raft).startElection()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x550
  6.824/raft.(*Raft).ticker.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:615 +0x34
==================
003683 TIMR S1 T2 reset election timeout. (RequestVote: 1 vote for 0)
003684 LEAD S0 T2 achieved majority for term(2), 1 > 2 , converting to Leader! 
003688 TIMR S1 T2 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
003688 TIMR S2 T2 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
004693 TIMR S1 T2 reset election timeout. (HeartBeat: 0 -> 1, commitIndex 0)
004694 TIMR S2 T2 reset election timeout. (HeartBeat: 0 -> 2, commitIndex 0)
008918 TIMR S2 T2 follower election timeout, converting to Candidate
008932 VOTE S1 T2 vote for S2, converting to follower.
008933 TIMR S1 T3 reset election timeout. (RequestVote: 1 vote for 2)
008940 LEAD S2 T3 achieved majority for term(2), 1 > 3 , converting to Leader! 
008949 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
009955 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
010955 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
010956 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
011959 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
011959 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
012959 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
012959 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
013973 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
013973 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
014973 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
014974 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
019164 TIMR S0 T3 follower election timeout, converting to Candidate
019419 TIMR S1 T3 follower election timeout, converting to Candidate
023043 TIMR S1 T4 candidate election timeout, converting to Candidate
023967 TIMR S0 T4 candidate election timeout, converting to Candidate
026915 TIMR S1 T5 candidate election timeout, converting to Candidate
027834 TIMR S0 T5 candidate election timeout, converting to Candidate
030685 TIMR S1 T6 candidate election timeout, converting to Candidate
032227 TIMR S0 T6 candidate election timeout, converting to Candidate
035204 TIMR S1 T7 candidate election timeout, converting to Candidate
036177 TIMR S0 T7 candidate election timeout, converting to Candidate
038717 TIMR S1 T8 candidate election timeout, converting to Candidate
038725 VOTE S0 T8 vote for S1, converting to follower.
038726 TIMR S0 T9 reset election timeout. (RequestVote: 0 vote for 1)
038730 LEAD S1 T9 achieved majority for term(2), 1 > 9 , converting to Leader! 
038737 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
039746 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
040756 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
041762 TIMR S2 T9 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
041762 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
042756 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
042756 TIMR S2 T9 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
043756 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
043756 TIMR S2 T9 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
044759 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
044759 TIMR S2 T9 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
045767 TIMR S0 T9 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
045767 TIMR S2 T9 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
--- FAIL: TestReElection2A (4.59s)
    testing.go:1465: race detected during execution of test
FAIL
exit status 1
FAIL	6.824/raft	4.704s

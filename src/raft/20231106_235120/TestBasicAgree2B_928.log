000078 LOG1 S0, making...
000084 LOG1 S1, making...
000085 LOG1 S2, making...
Test (2B): basic agreement ...
003866 TIMR S2 T0 follower election timeout, converting to Candidate
003875 VOTE S1 T0 vote for S2, converting to follower.
003875 TIMR S1 T1 reset election timeout. (RequestVote: 1 vote for 2)
003878 VOTE S0 T0 vote for S2, converting to follower.
003878 TIMR S0 T1 reset election timeout. (RequestVote: 0 vote for 2)
003881 LEAD S2 T1 achieved majority for term(2), 1 > 1 , converting to Leader! 
003891 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
003893 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
004153 CLNT S2 leader Term 1 append new log nextIndex2 matchIndex1
004245 LEAD S2 leader Term 1 Broadcast appendEntries
004246 LEAD S2 prevIndex0
004247 LEAD S2 prevIndex0
004304 LOG2 S1 follower Term1 append new log, len(rf.log) 1, args.PrevLogIndex 0
004305 WARN S1 follower Term1 append new log, len 2
004307 LEAD S2 leader Term 1 appendEntries success: commitIndex1
004384 LOG2 S0 follower Term1 append new log, len(rf.log) 1, args.PrevLogIndex 0
004384 WARN S0 follower Term1 append new log, len 2
004386 LEAD S2 leader Term 1 appendEntries success: commitIndex1
004399 CMIT S2 leader Term1 commit{CommandIndex:1}
004400 CMIT S2 leader Term1 commit
005396 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
005403 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
005461 CMIT S0 follower Term1 commit{CommandIndex:1}
005462 CMIT S0 follower Term1 commit
005462 CMIT S1 follower Term1 commit{CommandIndex:1}
005463 CMIT S1 follower Term1 commit
005616 CLNT S2 leader Term 1 append new log nextIndex3 matchIndex2
006211 LEAD S2 leader Term 1 Broadcast appendEntries
006212 LEAD S2 prevIndex1
006213 LEAD S2 prevIndex1
006468 LOG2 S1 follower Term1 append new log, len(rf.log) 2, args.PrevLogIndex 1
006469 WARN S1 follower Term1 append new log, len 3
006474 LEAD S2 leader Term 1 appendEntries success: commitIndex2
006475 CMIT S2 leader Term1 commit{CommandIndex:2}
006475 CMIT S2 leader Term1 commit
006931 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 1)
006941 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 1)
006957 LOG2 S0 follower Term1 append new log, len(rf.log) 2, args.PrevLogIndex 1
006958 WARN S0 follower Term1 append new log, len 3
007012 CMIT S1 follower Term1 commit{CommandIndex:2}
007013 CMIT S1 follower Term1 commit
007704 LEAD S2 leader Term 1 appendEntries success: commitIndex2
008414 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 2)
008417 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 1)
008428 CMIT S0 follower Term1 commit{CommandIndex:2}
008440 CMIT S0 follower Term1 commit
009548 CLNT S2 leader Term 1 append new log nextIndex4 matchIndex3
010047 LEAD S2 leader Term 1 Broadcast appendEntries
010048 LEAD S2 prevIndex2
010083 LOG2 S0 follower Term1 append new log, len(rf.log) 3, args.PrevLogIndex 2
010084 WARN S0 follower Term1 append new log, len 4
010048 LEAD S2 prevIndex2
010157 LEAD S2 leader Term 1 appendEntries success: commitIndex3
==================
WARNING: DATA RACE
Read at 0x00c0001222a0 by goroutine 32:
  6.824/raft.(*Raft).startHeartBeat.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:377 +0xc0

Previous write at 0x00c0001222a0 by goroutine 69:
  6.824/raft.(*Raft).LeaderAppendEntries.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:687 +0x488
  6.824/raft.(*Raft).LeaderAppendEntries.func2()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:703 +0xbc

Goroutine 32 (running) created at:
  6.824/raft.(*Raft).startHeartBeat()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:368 +0xb4
  6.824/raft.(*Raft).startElection.func3()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x34

Goroutine 69 (finished) created at:
  6.824/raft.(*Raft).LeaderAppendEntries()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:663 +0x76c
  6.824/raft.Make.func2()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:778 +0x34
==================
010180 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 2)
010183 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 2)
010260 CMIT S2 leader Term1 commit{CommandIndex:3}
010261 CMIT S2 leader Term1 commit
010266 LOG2 S1 follower Term1 append new log, len(rf.log) 3, args.PrevLogIndex 2
010266 WARN S1 follower Term1 append new log, len 4
010269 LEAD S2 leader Term 1 appendEntries success: commitIndex3
010273 CMIT S0 follower Term1 commit{CommandIndex:3}
010274 CMIT S0 follower Term1 commit
011690 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 3)
011695 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 2)
011821 CMIT S1 follower Term1 commit{CommandIndex:3}
011822 CMIT S1 follower Term1 commit
--- FAIL: TestBasicAgree2B (1.19s)
    testing.go:1465: race detected during execution of test
FAIL
exit status 1
FAIL	6.824/raft	5.248s

000006 LOG1 S0, making...
000011 LOG1 S1, making...
000012 LOG1 S2, making...
Test (2A): election after network failure ...
004016 TIMR S0 T0 follower election timeout, converting to Candidate
004032 TIMR S2 T0 follower election timeout, converting to Candidate
004033 VOTE S2 T0 vote for S0, converting to follower.
004033 VOTE S1 T0 vote for S0, converting to follower.
004033 TIMR S2 T1 reset election timeout. (RequestVote: 2 vote for 0)
004034 TIMR S1 T1 reset election timeout. (RequestVote: 1 vote for 0)
004039 LEAD S0 T1 achieved majority for term(2), 1 > 1 , converting to Leader! 
004039 VOTE S1 T1 vote for S2, converting to follower.
004040 TIMR S1 T2 reset election timeout. (RequestVote: 1 vote for 2)
004040 VOTE S0 T1 vote for S2, converting to follower.
==================
WARNING: DATA RACE
Write at 0x00c0000d20f8 by goroutine 36:
  6.824/raft.(*Raft).RequestVote()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:413 +0x19c
  runtime.call32()
      /usr/local/go/src/runtime/asm_arm64.s:479 +0x74
  reflect.Value.Call()
      /usr/local/go/src/reflect/value.go:380 +0x90
  6.824/labrpc.(*Service).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:496 +0x334
  6.824/labrpc.(*Server).dispatch()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:420 +0x1f0
  6.824/labrpc.(*Network).processReq.func1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:240 +0x84

Previous read at 0x00c0000d20f8 by goroutine 37:
  6.824/raft.(*Raft).startHeartBeat()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:367 +0x30
  6.824/raft.(*Raft).startElection.func3()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x34

Goroutine 36 (running) created at:
  6.824/labrpc.(*Network).processReq()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:239 +0x20c
  6.824/labrpc.MakeNetwork.func1.1()
      /Users/dengjie/mit6.824/6.824/src/labrpc/labrpc.go:157 +0x84

Goroutine 37 (finished) created at:
  6.824/raft.(*Raft).startElection()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:591 +0x550
  6.824/raft.(*Raft).ticker.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:615 +0x34
==================
004052 TIMR S0 T2 reset election timeout. (RequestVote: 0 vote for 2)
007705 TIMR S2 T2 follower election timeout, converting to Candidate
007707 VOTE S0 T2 vote for S2, converting to follower.
007707 VOTE S1 T2 vote for S2, converting to follower.
007708 TIMR S0 T3 reset election timeout. (RequestVote: 0 vote for 2)
007708 TIMR S1 T3 reset election timeout. (RequestVote: 1 vote for 2)
007709 LEAD S2 T3 achieved majority for term(2), 1 > 3 , converting to Leader! 
007714 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
007714 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
009224 TIMR S1 T3 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
009224 TIMR S0 T3 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
013857 TIMR S1 T3 follower election timeout, converting to Candidate
013859 VOTE S0 T3 vote for S1, converting to follower.
013859 TIMR S0 T4 reset election timeout. (RequestVote: 0 vote for 1)
013860 LEAD S1 T4 achieved majority for term(2), 1 > 4 , converting to Leader! 
013862 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
015373 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
015373 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
016871 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
016871 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
018381 TIMR S2 T4 reset election timeout. (HeartBeat: 1 -> 2, commitIndex 0)
018381 TIMR S0 T4 reset election timeout. (HeartBeat: 1 -> 0, commitIndex 0)
023025 TIMR S0 T4 follower election timeout, converting to Candidate
023044 TIMR S2 T4 follower election timeout, converting to Candidate
026922 TIMR S0 T5 candidate election timeout, converting to Candidate
027396 TIMR S2 T5 candidate election timeout, converting to Candidate
031307 TIMR S2 T6 candidate election timeout, converting to Candidate
031337 TIMR S0 T6 candidate election timeout, converting to Candidate
035586 TIMR S2 T7 candidate election timeout, converting to Candidate
035793 TIMR S0 T7 candidate election timeout, converting to Candidate
039828 TIMR S2 T8 candidate election timeout, converting to Candidate
039834 VOTE S0 T8 vote for S2, converting to follower.
039834 TIMR S0 T9 reset election timeout. (RequestVote: 0 vote for 2)
039836 LEAD S2 T9 achieved majority for term(2), 1 > 9 , converting to Leader! 
039838 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
041350 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
042850 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
044356 TERM S1 T4 converting to follower. Term too small (4 -> 9)
044357 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
044356 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
045868 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
045869 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
047380 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
047380 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
048883 TIMR S0 T9 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
048884 TIMR S1 T9 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
--- FAIL: TestReElection2A (4.94s)
    testing.go:1465: race detected during execution of test
FAIL
exit status 1
FAIL	6.824/raft	24.303s

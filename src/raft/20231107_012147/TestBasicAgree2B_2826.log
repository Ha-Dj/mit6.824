000045 LOG1 S0, making...
000061 LOG1 S1, making...
000063 LOG1 S2, making...
Test (2B): basic agreement ...
004551 TIMR S2 T0 follower election timeout, converting to Candidate
004570 VOTE S1 T0 vote for S2, converting to follower.
004571 TIMR S1 T1 reset election timeout. (RequestVote: 1 vote for 2)
004574 LEAD S2 T1 achieved majority for term(2), 1 > 1 , converting to Leader! 
004586 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
004551 TIMR S0 T0 follower election timeout, converting to Candidate
004612 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
005054 CLNT S2 leader Term 1 append new log nextIndex2 matchIndex1
005151 LEAD S2 leader Term 1 Broadcast appendEntries
005152 LEAD S2 prevIndex0
005153 LEAD S2 prevIndex0
005292 LOG2 S1 follower Term1 append new log, len(rf.log) 1, args.PrevLogIndex 0
005293 WARN S1 follower Term1 append new log, len 2
005295 LEAD S2 leader Term 1 appendEntries success: commitIndex1
005297 LOG2 S0 candidate Term1 append new log, len(rf.log) 1, args.PrevLogIndex 0
005299 WARN S0 candidate Term1 append new log, len 2
005307 LEAD S2 leader Term 1 appendEntries success: commitIndex1
005393 CMIT S2 leader Term1 commit{CommandIndex:1}
005394 CMIT S2 leader Term1 commit
005584 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 0)
005584 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 0)
005609 CMIT S1 follower Term1 commit{CommandIndex:1}
005610 CMIT S1 follower Term1 commit
005611 CMIT S0 candidate Term1 commit{CommandIndex:1}
005625 CMIT S0 candidate Term1 commit
005722 CLNT S2 leader Term 1 append new log nextIndex3 matchIndex2
006259 LEAD S2 leader Term 1 Broadcast appendEntries
006259 LEAD S2 prevIndex1
006260 LEAD S2 prevIndex1
006334 LOG2 S1 follower Term1 append new log, len(rf.log) 2, args.PrevLogIndex 1
006335 WARN S1 follower Term1 append new log, len 3
006355 LOG2 S0 candidate Term1 append new log, len(rf.log) 2, args.PrevLogIndex 1
006356 WARN S0 candidate Term1 append new log, len 3
006359 LEAD S2 leader Term 1 appendEntries success: commitIndex2
006451 CMIT S2 leader Term1 commit{CommandIndex:2}
006452 CMIT S2 leader Term1 commit
006500 LEAD S2 leader Term 1 appendEntries success: commitIndex2
006643 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 1)
006691 CMIT S1 follower Term1 commit{CommandIndex:2}
006691 CMIT S1 follower Term1 commit
006739 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 1)
006828 CMIT S0 candidate Term1 commit{CommandIndex:2}
006829 CMIT S0 candidate Term1 commit
007122 CLNT S2 leader Term 1 append new log nextIndex4 matchIndex3
007253 LEAD S2 leader Term 1 Broadcast appendEntries
007254 LEAD S2 prevIndex2
007254 LEAD S2 prevIndex2
007706 LOG2 S1 follower Term1 append new log, len(rf.log) 3, args.PrevLogIndex 2
007706 WARN S1 follower Term1 append new log, len 4
007709 LEAD S2 leader Term 1 appendEntries success: commitIndex3
007718 LOG2 S0 candidate Term1 append new log, len(rf.log) 3, args.PrevLogIndex 2
007718 WARN S0 candidate Term1 append new log, len 4
007722 LEAD S2 leader Term 1 appendEntries success: commitIndex3
007740 CMIT S2 leader Term1 commit{CommandIndex:3}
007748 CMIT S2 leader Term1 commit
==================
WARNING: DATA RACE
Read at 0x00c00015c2a0 by goroutine 32:
  6.824/raft.(*Raft).startHeartBeat.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:379 +0xc0

Previous write at 0x00c00015c2a0 by goroutine 71:
  6.824/raft.(*Raft).LeaderAppendEntries.func1()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:689 +0x488
  6.824/raft.(*Raft).LeaderAppendEntries.func2()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:705 +0xbc

Goroutine 32 (running) created at:
  6.824/raft.(*Raft).startHeartBeat()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:370 +0xc0
  6.824/raft.(*Raft).startElection.func3()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:593 +0x34

Goroutine 71 (finished) created at:
  6.824/raft.(*Raft).LeaderAppendEntries()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:665 +0x76c
  6.824/raft.Make.func2()
      /Users/dengjie/mit6.824/6.824/src/raft/raft.go:780 +0x34
==================
008034 TIMR S0 T1 reset election timeout. (HeartBeat: 2 -> 0, commitIndex 2)
008098 CMIT S0 candidate Term1 commit{CommandIndex:3}
008099 CMIT S0 candidate Term1 commit
008225 TIMR S1 T1 reset election timeout. (HeartBeat: 2 -> 1, commitIndex 2)
008232 CMIT S1 follower Term1 commit{CommandIndex:3}
008233 CMIT S1 follower Term1 commit
--- FAIL: TestBasicAgree2B (0.83s)
    testing.go:1465: race detected during execution of test
FAIL
exit status 1
FAIL	6.824/raft	1.848s
